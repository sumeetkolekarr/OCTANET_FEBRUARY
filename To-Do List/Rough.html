<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>To-Do List</title>
  <!-- Include SweetAlert library -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
  <input type="text" id="todoInput" placeholder="Enter a new todo" />
  <button onclick="addTodo()">Add Todo</button>

  <h2>Active Tasks</h2>
  <ul id="todoList">
    <!-- Active To-Do items will be displayed here -->
  </ul>

  <h2>Priority Tasks</h2>
  <ul id="priorityList">
    <!-- Priority To-Do items will be displayed here -->
  </ul>

  <h2>Completed Tasks</h2>
  <ul id="completedList">
    <!-- Completed To-Do items will be displayed here -->
  </ul>

  <h2>Percentage Completed:</h2>
  <p id="percent"></p>
  <h2>Decimal:</h2>
  <p id="decimal"></p>


  <script>
    let todos = [];
    let completed = [];
    let priority = [];

    function loadTodos() {
      const todosJSON = localStorage.getItem("todos");
      const completedJSON = localStorage.getItem("completed");
      const priorityJSON = localStorage.getItem("priority");

      let completedCount = 0;
      if (completedJSON !== null) {
        completed = JSON.parse(completedJSON);
        completedCount = completed.length;
      }

      let priorityCount = 0;
      if (priorityJSON !== null) {
        priority = JSON.parse(priorityJSON);
        priorityCount = priority.length;
      }

      const totalCount = todos.length + completedCount + priorityCount;
      const percent = (completedCount / totalCount) * 100 || 0;

      document.getElementById("percent").innerHTML = `${Math.round(percent)}%`;
      document.getElementById("decimal").innerHTML = `${completedCount}/${totalCount}`;

      if (todosJSON !== null) {
        todos = JSON.parse(todosJSON);
        displayTodos();
      }
    }

    function saveTodos() {
      localStorage.setItem("todos", JSON.stringify(todos));
      localStorage.setItem("completed", JSON.stringify(completed));
      localStorage.setItem("priority", JSON.stringify(priority));
    }

    function displayTodos() {
      displayList("todoList", todos);
      displayList("priorityList", priority);
      displayList("completedList", completed);

      saveTodos();
    }

    function displayList(listId, items) {
      const list = document.getElementById(listId);
      list.innerHTML = "";
      items.forEach((item, index) => {
        const li = createTodoElement(item, index, listId === "completedList", listId === "priorityList");
        list.appendChild(li);
      });
    }

    function createTodoElement(todo, index, isCompleted = false, isPriority = false) {
      const li = document.createElement("li");
      li.textContent = `${index + 1}. ${todo}`;

      const editButton = document.createElement("button");
      editButton.textContent = "Edit";
      editButton.className = "editButton";
      editButton.onclick = function () {
        editTodo(index, isCompleted, isPriority);
      };

      const doneButton = document.createElement("button");
      doneButton.textContent = isCompleted ? "Undone" : "Done";
      doneButton.className = isCompleted ? "undoneButton" : "doneButton";
      doneButton.onclick = function () {
        toggleDone(index, isCompleted);
        location.reload();
      };

      const deleteButton = document.createElement("button");
      deleteButton.textContent = "Delete";
      deleteButton.className = "deleteButton";
      deleteButton.onclick = function () {
        removeTodo(index, isCompleted, isPriority);
      };

      li.appendChild(editButton);
      li.appendChild(doneButton);
      li.appendChild(deleteButton);

      if (isCompleted) {
        li.classList.add("done");
      }
      if (isPriority) {
        li.classList.add("priority");
      }

      return li;
    }

    function editTodo(index, isCompleted, isPriority) {
      const targetArray = isCompleted ? completed : (isPriority ? priority : todos);
      const newTodo = prompt("Edit your todo:", targetArray[index]);
      if (newTodo !== null) {
        targetArray[index] = newTodo.trim();
        displayTodos();
        Swal.fire("ToDo Edited Successfully!", "", "success");
      }
    }

    function toggleDone(index, isCompleted) {
      const targetArray = isCompleted ? completed : todos;
      const completedTodo = targetArray.splice(index, 1)[0];
      if (!isCompleted) {
        completed.push(completedTodo);
      } else {
        todos.push(completedTodo);
      }
      displayTodos();
    }

    function addTodo() {
      const todoInput = document.getElementById("todoInput");
      const todoText = todoInput.value.trim();

      if (todoText !== "" && todos.length < 7) {
        todos.push(todoText);
        todoInput.value = "";
        displayTodos();
        Swal.fire("ToDo Added Successfully!", "", "success");
      } else if (todoText === "") {
        Swal.fire("Enter the Task!", "", "warning");
      } else if (todos.length >= 7) {
        Swal.fire("Complete the earlier Given Tasks!", "", "warning");
      }
    }

    function removeTodo(index, isCompleted, isPriority) {
      const targetArray = isCompleted ? completed : (isPriority ? priority : todos);
      if (index >= 0 && index < targetArray.length) {
        targetArray.splice(index, 1);
        displayTodos();
      }
    }

    loadTodos();
  </script>
</body>
</html>
